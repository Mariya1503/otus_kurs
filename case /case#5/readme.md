#  Доступ к сетевым устройствам по протоколу SSH

![](figure1.png)

###  Задание:

Часть 1. Настройка основных параметров устройства

Часть 2. Настройка маршрутизатора для доступа по протоколу SSH

Часть 3. Настройка коммутатора для доступа по протоколу SSH

Часть 4. SSH через интерфейс командной строки (CLI) коммутатора

###  Исходные данные:

| Устройство       | Интерфейс      | IP-адрес / префикс       | Маска подсети | Шлюз по умолчанию |
|-----------------:|:---------------|-------------------------:|--------------:|-----------------:|
| R1               | G0/0/1        | 192.168.1.1          | 255.255.255.0 | - |
| S1               | Vlan 1         | 192.168.1.11          | 255.255.255.0 | 192.168.1.1 |
| PC-A             | NIC            | 192.168.1.3         | 255.255.255.0 | 192.168.1.1 |

###  Решение:

# Часть 1.Настройка основных параметров устройств

В части 1 потребуется настроить топологию сети и основные параметры, такие как IP-адреса интерфейсов, доступ к устройствам и пароли на маршрутизаторе.

###  1. Создайте сеть согласно топологии.

![](figure2.png)

### 2. Выполните инициализацию и перезагрузку маршрутизатора и коммутатора.

### 3. Настройте маршрутизатор.

Откройте окно конфигурации
  a. Подключитесь к маршрутизатору с помощью консоли и активируйте привилегированный режим EXEC.
  
  b. Войдите в режим конфигурации.
  
  c. Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.

*no ip domain-lookup*

 d. Назначьте class в качестве зашифрованного пароля привилегированного режима EXEC.

*!*

*enable secret 5 $1$mERr$9cTjUIEqNGurQiFU.ZeCi1*

*!*

 e. Назначьте cisco в качестве пароля консоли и включите вход в систему по паролю.
 
 f. Назначьте cisco в качестве пароля VTY и включите вход в систему по паролю.
 
 g. Зашифруйте открытые пароли.

    *!*
  
    *line con 0*

    *password 7 0822455D0A16*

    *login*

    *!*

    *line aux 0*

    *!*

    *line vty 0 4*

    *password 7 0822455D0A16*

    *login*

    *line vty 5 15*

    *password 7 0822455D0A16*

    *login*

    *!*

 h. Создайте баннер, который предупреждает о запрете несанкционированного доступа.

    *banner motd ^C Unauthorized access is strictly prohibited ^C*

 i. Настройте и активируйте на маршрутизаторе интерфейс G0/0/1, используя информацию, приведенную в таблице адресации.

    *!*

    *interface GigabitEthernet0/0/1*

    *ip address 192.168.1.1 255.255.255.0*

    *duplex auto*

    *speed auto*

    *!*

 j. Сохраните текущую конфигурацию в файл загрузочной конфигурации.

    *R1#copy running-config startup-config*

    *Destination filename [startup-config]?*

    *Building configuration...*

    *[OK]*

### 4. Настройте компьютер PC-A.

 a. Настройте для PC-A IP-адрес и маску подсети.
 
 b. Настройте для PC-A шлюз по умолчанию.

![](figure3.png)


### 5. Проверьте подключение к сети.

Пошлите с PC-A команду Ping на маршрутизатор R1. Если эхо-запрос с помощью команды ping не проходит, найдите и устраните неполадки подключения.

*C:\> ping 192.168.1.1*

*Pinging 192.168.1.1 with 32 bytes of data:*

*Reply from 192.168.1.1: bytes=32 time=28ms TTL=255*

*Reply from 192.168.1.1: bytes=32 time<1ms TTL=255*

*Reply from 192.168.1.1: bytes=32 time<1ms TTL=255*

*Reply from 192.168.1.1: bytes=32 time<1ms TTL=255*

*Ping statistics for 192.168.1.1:*

*Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),*

*Approximate round trip times in milli-seconds:*

*Minimum = 0ms, Maximum = 28ms, Average = 7ms*

  # Часть 2. Настройка базовых параметров сетевых устройств

Во второй части необходимо будет настроить основные параметры коммутатора и компьютера.
 
  ###  1. Настройте базовые параметры коммутатора.

  a.	В режиме глобальной конфигурации скопируйте следующие базовые параметры конфигурации и вставьте их в файл на коммутаторе S1.
  
no ip domain-lookup

hostname S1

service password-encryption

enable secret class

banner motd # Unauthorized access is strictly prohibited. #

b.	Назначьте IP-адрес интерфейсу SVI на коммутаторе. Благодаря этому вы получите возможность удаленного управления коммутатором.

Прежде чем вы сможете управлять коммутатором S1 удаленно с компьютера PC-A, коммутатору нужно назначить IP-адрес. Согласно конфигурации по умолчанию коммутатором можно управлять через VLAN 1.

c.	Доступ через порт консоли также следует ограничить  с помощью пароля. Используйте cisco в качестве пароля для входа в консоль в этом задании. Конфигурация по умолчанию разрешает все консольные подключения без пароля. Чтобы консольные сообщения не прерывали выполнение команд, используйте параметр logging synchronous.

S1(config)# line con 0

S1(config-line)# logging synchronous

d.	Настройте каналы виртуального соединения для удаленного управления (vty), чтобы коммутатор разрешил доступ через Telnet. Если не настроить пароль VTY, будет невозможно подключиться к коммутатору по протоколу Telnet.

Для чего нужна команда login? — команда требует ввода пароля при подключении по консоли

###  2. Настройте IP-адрес на компьютере PC-A.

Назначьте компьютеру IP-адрес и маску подсети в соответствии с таблицей адресации.

| Устройство       | Интерфейс      | IP-адрес / префикс       |
|-----------------:|:---------------|-------------------------:|
| S1               | Vlan 1         | 192.168.1.2 /24          |
| PC-A             | NIC            | 192.168.1.10 /24         |


 # Часть 3. Проверка сетевых подключений
 
В третьей части лабораторной работы вам предстоит проверить и задокументировать конфигурацию коммутатора, протестировать сквозное соединение между компьютером PC-A и коммутатором S1, а также протестировать возможность удаленного управления коммутатором.

###  1. Отобразите конфигурацию коммутатора.

a.	Используйте консольное подключение на компьютере PC-A для отображения и проверки конфигурации коммутатора. Команда show run позволяет постранично отобразить всю текущую конфигурацию.

 Файл текущей конфигурации [здесь](config_1.txt).

 b.	Проверьте параметры VLAN 1.
 
S1# show interface vlan 1

S1# show interface vlan 1

Vlan1 is up, line protocol is up

Hardware is CPU Interface, address is 00e0.b051.4598 (bia 00e0.b051.4598)

Internet address is 192.168.1.2/24

MTU 1500 bytes, BW 100000 Kbit, DLY 1000000 usec,

reliability 255/255, txload 1/255, rxload 1/255

Encapsulation ARPA, loopback not set

ARP type: ARPA, ARP Timeout 04:00:00

Last input 21:40:21, output never, output hang never

Last clearing of "show interface" counters never

Input queue: 0/75/0/0 (size/max/drops/flushes); Total output drops: 0

Queueing strategy: fifo

Output queue: 0/40 (size/max)

5 minute input rate 0 bits/sec, 0 packets/sec

5 minute output rate 0 bits/sec, 0 packets/sec

1682 packets input, 530955 bytes, 0 no buffer

Received 0 broadcasts (0 IP multicast)

0 runts, 0 giants, 0 throttles

0 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored

563859 packets output, 0 bytes, 0 underruns

0 output errors, 23 interface resets

0 output buffer failures, 0 output buffers swapped out

Какова полоса пропускания этого интерфейса? - MTU 1500 bytes.

###  2. Протестируйте сквозное соединение, отправив эхо-запрос.

a.	В командной строке компьютера PC-A с помощью утилиты ping проверьте связь сначала с адресом PC-A.

C:\>ping 192.168.1.10

Pinging 192.168.1.10 with 32 bytes of data:

Reply from 192.168.1.10: bytes=32 time=1ms TTL=128

Reply from 192.168.1.10: bytes=32 time=4ms TTL=128

Reply from 192.168.1.10: bytes=32 time=3ms TTL=128

Reply from 192.168.1.10: bytes=32 time=4ms TTL=128

Ping statistics for 192.168.1.10:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

Approximate round trip times in milli-seconds:

Minimum = 1ms, Maximum = 4ms, Average = 3ms

b.	Из командной строки компьютера PC-A отправьте эхо-запрос на административный адрес интерфейса SVI коммутатора S1.

C:\> ping 192.168.1.2

Pinging 192.168.1.2 with 32 bytes of data:

Reply from 192.168.1.2: bytes=32 time<1ms TTL=255

Reply from 192.168.1.2: bytes=32 time<1ms TTL=255

Reply from 192.168.1.2: bytes=32 time<1ms TTL=255

Reply from 192.168.1.2: bytes=32 time<1ms TTL=255

Ping statistics for 192.168.1.2:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

Approximate round trip times in milli-seconds:

Minimum = 0ms, Maximum = 0ms, Average = 0ms

###  3. Проверьте удаленное управление коммутатором S1.

a.	Откройте Tera Term или другую программу эмуляции терминала с возможностью Telnet.

b.	Выберите сервер Telnet и укажите адрес управления SVI для подключения к S1.  Пароль: cisco.

c.	После ввода пароля cisco вы окажетесь в командной строке пользовательского режима. Для перехода в исполнительский режим EXEC введите команду enable и используйте секретный пароль class.

d.	Сохраните конфигурацию. - Файл текущей конфигурации [здесь](Telnet_config_1.txt).

# Вопросы для повторения

1.	Зачем необходимо настраивать пароль VTY для коммутатора?
   
   Чтобы ограничить удаленный доступ к устройству через Telnet или SSH.

3.	Что нужно сделать, чтобы пароли не отправлялись в незашифрованном виде?
   
   Чтобы зашифровать пароли, нужно воспользоваться командой service password-encryption в режиме глобальной конфигурации.

Файл лабораторной работы Cisco PT [здесь](lab1.pkt).

